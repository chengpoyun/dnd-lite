# D&D Lite - é–‹ç™¼è€…æŒ‡å— ğŸ“‹

> å°ˆç‚º D&D 5e è¨­è¨ˆçš„ç¾ä»£è§’è‰²ç®¡ç†æ‡‰ç”¨ç¨‹å¼é–‹ç™¼æ–‡æª”

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### æ ¸å¿ƒåŸå‰‡
- **é›²ç«¯å„ªå…ˆ** - å®Œå…¨ä½¿ç”¨ Supabase PostgreSQLï¼Œé›¶ localStorage ä¾è³´
- **é¡å‹å®‰å…¨** - å…¨é¢çš„ TypeScript é¡å‹å®šç¾©
- **æ¸¬è©¦é©…å‹•** - 124å€‹å–®å…ƒæ¸¬è©¦ç¢ºä¿ç¨‹å¼ç¢¼å“è³ª
- **éŸ¿æ‡‰å¼è¨­è¨ˆ** - æ‰‹æ©Ÿå„ªå…ˆçš„ UI/UX è¨­è¨ˆ

### æŠ€è¡“æ¶æ§‹
```
â”œâ”€â”€ å‰ç«¯å±¤ (React 19 + TypeScript)
â”‚   â”œâ”€â”€ çµ„ä»¶ç³»çµ± (components/)
â”‚   â”œâ”€â”€ æ¥­å‹™é‚è¼¯ (services/)
â”‚   â””â”€â”€ å·¥å…·å‡½æ•¸ (utils/)
â”œâ”€â”€ ç‹€æ…‹ç®¡ç† (React Context + useState)
â”œâ”€â”€ æ¨£å¼ç³»çµ± (Tailwind CSS + è‡ªå®šç¾© CSS)
â””â”€â”€ å¾Œç«¯æœå‹™ (Supabase)
    â”œâ”€â”€ è³‡æ–™åº« (PostgreSQL)
    â”œâ”€â”€ èªè­‰ç³»çµ± (Auth)
    â””â”€â”€ å³æ™‚åŒæ­¥ (Realtime)
```

## ğŸ”§ é—œéµæœå‹™

### è³‡æ–™ç®¡ç†å±¤
- **`HybridDataManager`** - çµ±ä¸€è³‡æ–™å­˜å–ä»‹é¢
- **`DetailedCharacterService`** - è§’è‰²å®Œæ•´è³‡æ–™ CRUD
- **`UserSettingsService`** - ä½¿ç”¨è€…åå¥½è¨­å®š
- **`AnonymousService`** - åŒ¿åç”¨æˆ¶æ”¯æ´
- **`AuthService`** - èªè­‰èˆ‡æˆæ¬Š

### æ¥­å‹™é‚è¼¯å±¤
- **`characterItems`** - æˆ°é¬¥ç‰©å“èˆ‡å‹•ä½œç®¡ç†
- **`databaseInit`** - è³‡æ–™åº«åˆå§‹åŒ–é‚è¼¯
- **`classUtils`** - è·æ¥­ç³»çµ±èˆ‡å…¼è·æ”¯æ´
- **`migrationHelpers`** - è³‡æ–™é·ç§»è¼”åŠ©

## ğŸ—„ï¸ è³‡æ–™åº«è¨­è¨ˆ

### ä¸»è¦è¡¨æ ¼
```sql
characters                    -- è§’è‰²ä¸»è¡¨
â”œâ”€â”€ character_ability_scores  -- èƒ½åŠ›å€¼
â”œâ”€â”€ character_current_stats   -- ç•¶å‰ç‹€æ…‹ (HP, AC, å…ˆæ”»)
â”œâ”€â”€ character_currency        -- è²¨å¹£ç³»çµ±
â”œâ”€â”€ character_combat_actions  -- æˆ°é¬¥å‹•ä½œ
â””â”€â”€ character_skill_proficiencies -- æŠ€èƒ½ç†Ÿç·´åº¦

user_settings                 -- ä½¿ç”¨è€…è¨­å®š
```

### RLS å®‰å…¨ç­–ç•¥
- æ‰€æœ‰è¡¨æ ¼å•Ÿç”¨ Row Level Security
- ä½¿ç”¨è€…åªèƒ½å­˜å–è‡ªå·±çš„è³‡æ–™
- åŒ¿åä½¿ç”¨è€…æ”¯æ´ `anonymous_id` æ©Ÿåˆ¶

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### æ¸¬è©¦è¦†è“‹ç¯„åœ
- **å–®å…ƒæ¸¬è©¦** - æ‰€æœ‰æ ¸å¿ƒå‡½æ•¸ 100% è¦†è“‹
- **æ•´åˆæ¸¬è©¦** - å…ƒä»¶èˆ‡æœå‹™æ•´åˆ
- **ç«¯åˆ°ç«¯æ¸¬è©¦** - é—œéµä½¿ç”¨è€…æµç¨‹

### æ¸¬è©¦æª”æ¡ˆçµæ§‹
```
src/test/
â”œâ”€â”€ avatar-save.test.ts          -- é ­åƒå„²å­˜
â”œâ”€â”€ character-data-services.test.ts -- è§’è‰²è³‡æ–™æœå‹™
â”œâ”€â”€ CharacterSheet.test.tsx      -- è§’è‰²è¡¨çµ„ä»¶
â”œâ”€â”€ classUtils.test.ts           -- è·æ¥­å·¥å…·å‡½æ•¸
â”œâ”€â”€ CombatView.*.test.tsx        -- æˆ°é¬¥ä»‹é¢
â”œâ”€â”€ DeleteFunction.*.test.tsx    -- åˆªé™¤åŠŸèƒ½
â”œâ”€â”€ save-logic.test.ts           -- å„²å­˜é‚è¼¯
â””â”€â”€ updateExtraData.test.ts      -- é¡å¤–è³‡æ–™æ›´æ–°
```

## ğŸš€ é–‹ç™¼å·¥ä½œæµç¨‹

### æœ¬åœ°é–‹ç™¼
```bash
npm run dev     # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ (localhost:5173)
npm test        # é‹è¡Œæ‰€æœ‰æ¸¬è©¦
npm run build   # å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬
```

### è³‡æ–™åº«ç®¡ç†
```bash
npm run db:status   # æª¢æŸ¥é·ç§»ç‹€æ…‹
npm run db:migrate  # åŸ·è¡Œè³‡æ–™åº«é·ç§»
npm run db:create "description"  # å‰µå»ºæ–°é·ç§»
```

## ğŸ“ AI åŠ©ç†å·¥ä½œè¦ç¯„

### æ–‡æª”å±¤ç´š
1. **å°ˆæ¡ˆå±¤ç´š** - ç·¨è¼¯ `.assistant-guidelines.md`
2. **å°è©±å±¤ç´š** - ç›´æ¥åœ¨å°è©±ä¸­æå‡ºè¦æ±‚
3. **ç¨‹å¼ç¢¼å±¤ç´š** - åœ¨è¨»é‡‹ä¸­æ·»åŠ å…·é«”æŒ‡å°

### ç¨‹å¼ç¢¼å“è³ªè¦æ±‚
- ä¿æŒ TypeScript åš´æ ¼æ¨¡å¼
- æ‰€æœ‰æ–°åŠŸèƒ½å¿…é ˆæœ‰å°æ‡‰æ¸¬è©¦
- éµå¾ªç¾æœ‰çš„å‘½åè¦ç¯„
- UI çµ„ä»¶é ˆæ”¯æ´éŸ¿æ‡‰å¼è¨­è¨ˆ

## ğŸ“ å°ˆæ¡ˆçµæ§‹
```
dnd-lite/
â”œâ”€â”€ components/          -- React çµ„ä»¶
â”œâ”€â”€ contexts/           -- React Context
â”œâ”€â”€ lib/               -- ç¬¬ä¸‰æ–¹å‡½å¼åº«é…ç½®
â”œâ”€â”€ services/          -- æ¥­å‹™é‚è¼¯æœå‹™
â”œâ”€â”€ src/               -- æ¸¬è©¦æª”æ¡ˆ
â”œâ”€â”€ styles/            -- å…±ç”¨æ¨£å¼
â”œâ”€â”€ utils/             -- å·¥å…·å‡½æ•¸
â”œâ”€â”€ supabase/          -- è³‡æ–™åº«é·ç§»
â””â”€â”€ scripts/           -- å»ºç½®è…³æœ¬

1. **ç·¨è¼¯å°ˆæ¡ˆæŒ‡å—**ï¼š
   ```bash
   code .assistant-guidelines.md
   ```

2. **åœ¨å°è©±ä¸­æŒ‡å®š**ï¼š
   ```
   è«‹åœ¨é€™å€‹å°ˆæ¡ˆä¸­éµå¾ªä»¥ä¸‹è¦å‰‡ï¼š
   - [å…·é«”è¦æ±‚]
   ```

3. **ä»£ç¢¼è¨»é‡‹æŒ‡å°**ï¼š
   ```typescript
   // AI: é€™å€‹å‡½æ•¸éœ€è¦ä¿æŒå‘å¾Œç›¸å®¹æ€§
   function legacyFunction() { ... }
   ```