# AI 協作工作守則

適用對象：  
- 使用本專案的開發者（你 / 其他人）  
- 各種協作的 AI 助手（包含現在的我）

## 目標

透過明確的流程，確保：
- 需求被充分理解與確認
- 有清楚、可執行的測試策略
- 實作結果可以被驗證且不破壞既有功能

---

## 流程總覽

1. 確認需求  
2. 設計驗收與測試方式  
3. 先實作測試  
4. 再實作需求  
5. 執行剛剛設計的測試  
6. 執行完整單元測試  
7. 向需求提出者回報結果

---

## 詳細守則

### 1. 需求確認（必須先討論）

當使用者提出需求時，AI 助手在「開始動手前」必須先與需求提出者討論並確認：

- **需求目標是什麼？**（期望達成的行為 / 效果）
- **輸入與輸出是什麼？**（資料格式、介面、UI/UX 等）
- **有沒有邊界條件與例外情況？**
- **是否牽涉現有功能或其他模組？**

若有任何不確定的地方，AI 助手應主動提出問題，直到需求被描述得足以實作與測試為止。

---

### 2. 設計測試與驗收方式

在需求確認完成後，AI 助手必須先思考並說明：

- **如何判斷這個需求算「完成」？**
- **有哪些測試案例？**  
  - 正常情境（Happy path）
  - 邊界情境
  - 錯誤或例外情境（若適用）

並將這些測試與驗收方式，**清楚寫出或說明給需求提出者確認**。  
在可能的情況下，測試應盡量以自動化測試（如單元測試、整合測試）呈現。

---

### 3. 先實作測試

在真正寫功能碼之前，AI 助手需要先實作對應的測試，包括但不限於：

- 單元測試（Unit Tests）
- 元件測試（Component Tests）
- API 測試（若需求相關）

原則：

- 測試應可重現需求說明中的驗收條件。
- 測試在功能尚未實作時，預期會「失敗」（紅燈）。

---

### 4. 再實作需求

在測試建立之後，才開始實作需求本身：

- 遵守專案現有的程式風格、架構與慣例。
- 若需要修改或重構既有程式碼，需注意是否影響其他功能。
- 盡量保持單一變更聚焦在該需求與相關測試上。

---

### 5. 執行剛剛設計的測試

需求實作完成後：

- 執行第 3 步實作的測試。
- 確認所有與本次需求相關的測試都通過。
- 若測試失敗，需先修正實作或測試本身，再重跑直到通過為止。

---

### 6. 執行完整單元測試

為避免破壞既有功能，AI 助手應：

- 執行專案中既有的完整單元測試（或目前可行的最大測試集合）。
- 確認：
  - 既有測試全部通過。
  - 若有與本次變更直接相關的測試變動，需有合理說明。

如果有測試失敗，需調查原因，必要時回頭修正程式碼或測試，直到狀態穩定。

---

### 7. 回報需求完成狀態

在以上流程都完成後，AI 助手才可以向需求提出者回報，內容至少包含：

- **本次需求的摘要**（做了什麼、為何這樣做）
- **測試說明**：
  - 新增或修改了哪些測試
  - 相關測試都已通過
- **完整單元測試的結果**（已執行且通過）
- **可能的影響範圍與後續建議**（若有）

若有任何無法完成、需人工介入或決策的部分，也要清楚註明。

---

## 適用範圍補充

- 本守則優先適用於：  
  - 影響邏輯、資料或 API 的變更  
  - 會影響多處功能的重構  
- 對於極小且風險極低的變更（如純文字文案），可視情況簡化測試流程，但**仍建議至少思考與說明驗收方式**。

---